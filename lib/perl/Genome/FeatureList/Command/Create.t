#!/gsc/bin/perl

use strict;
use warnings;

BEGIN {
    $ENV{UR_DBI_NO_COMMIT} = 1;
    $ENV{UR_USE_DUMMY_AUTOGENERATED_IDS} = 1; #FeatureLists generate their own IDs, but this is still a good idea
};

use Test::More tests => 10;

use above 'Genome';

use_ok('Genome::FeatureList::Command::Create');

my $test_bed_file = __FILE__ . '.bed';
ok(-e $test_bed_file, 'test file ' . $test_bed_file . ' exists');

my $create_command = Genome::FeatureList::Command::Create->create(
    name                => 'GFL test feature-list',
    format              => 'true-BED',
    content_type        => 'target region set',
    file_path           => $test_bed_file,
);
ok($create_command, 'constructed create command');
isa_ok($create_command, 'Genome::FeatureList::Command::Create');
my $feature_list = $create_command->execute;
ok($feature_list, 'command executed successfully');
isa_ok($feature_list, 'Genome::FeatureList', 'command returned a Genome::FeatureList');

my $create_command_lims = Genome::FeatureList::Command::Create->create(
    name                => 'agilent sureselect MOUSE exome v1 -- test',
    format              => '1-based',
    content_type        => 'target region set',
    file_id             => '90528',
);
ok($create_command_lims, 'constructed create command for a file_id');
isa_ok($create_command_lims, 'Genome::FeatureList::Command::Create');
my $feature_list_lims = $create_command_lims->execute();
ok($feature_list_lims, 'command executed successfully');
isa_ok($feature_list_lims, 'Genome::FeatureList', 'command returned a Genome::FeatureList');
