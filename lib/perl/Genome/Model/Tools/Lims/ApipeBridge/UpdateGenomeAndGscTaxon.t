#! /gsc/bin/perl

BEGIN {
    $ENV{UR_USE_DUMMY_AUTOGENERATED_IDS} = 1;
    $ENV{UR_DBI_NO_COMMIT} = 1;
    $ENV{UR_COMMAND_DUMP_STATUS_MESSAGES} = 1;
}

use strict;
use warnings;

use above 'Genome';

use Test::More;

use_ok('Genome::Model::Tools::Lims::ApipeBridge::FixTaxon') or die;

my $name = '__TEST_TAXON__';
my $taxon = Genome::Taxon->__define__(name => $name, domain => 'Eukaryota', estimated_genome_size => 10);
my $gsc_taxon = GSC::Organism::Taxon->create(id => $taxon->id, species_name => $name, domain => 'Eukaryota', pse_id => 1);

my $fixer = Genome::Model::Tools::Lims::ApipeBridge::FixTaxon->create(
    taxon => $taxon,
    name => 'estimated_genome_size',
    value => 10_000_000,
);
ok($fixer, 'create');
ok($fixer->execute, 'execute');
is($taxon->estimated_genome_size, $gsc_taxon->estimated_organism_genome_size, 'fixed est genoem size');

done_testing();
exit;

