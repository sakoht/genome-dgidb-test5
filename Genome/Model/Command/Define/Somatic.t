#!/gsc/bin/perl

use strict;
use warnings;

use Data::Dumper;
use above "Genome";
#use Test::More tests => 244;
use Test::More 'no_plan';

$ENV{UR_DBI_NO_COMMIT} = 1;
$ENV{UR_USE_DUMMY_AUTOGENERATED_IDS} = 1;

my $temp_data_dir = Genome::Utility::FileSystem->create_temp_directory('data_directory');

my $tumor_model = Genome::Model->create_mock(
    id => '-119000',
    name => 'test_tumor_reference_aligment',
    genome_model_id => '-119000',
    subject_name => 'test_subject',
    subject_type => 'sample_name',
    processing_profile_name => 'test_profile_that_we_promise_is_reference_alignment',
    processing_profile_id => '-3',
);

my $normal_model = Genome::Model->create_mock(
    id => '-120000',
    genome_model_id => '-120000',
    name => 'test_normal_reference_aligment',
    subject_name => 'test_subject',
    subject_type => 'sample_name',
    processing_profile_name => 'test_profile_that_we_promise_is_reference_alignment',
    processing_profile_id => '-3',
);

ok(my $define = Genome::Model::Command::Define::Somatic->create(
        tumor_model_id => $tumor_model->id,
        normal_model_id => $normal_model->id,
        data_directory => $temp_data_dir,
        subject_name => 'test_subject',
        model_name => 'somatic_test')
    , "created define command");
isa_ok($define, "Genome::Model::Command::Define::Somatic");
ok($define->execute, "executed define command");

ok(my $model_id = $define->result_model_id, "Got result model id");
ok(my $model = Genome::Model->get($model_id), "Got the model from result model id");
isa_ok($model, "Genome::Model::Somatic");

