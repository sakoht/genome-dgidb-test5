#!/gsc/bin/perl

use strict;
use warnings;

use above "Genome";
use Test::More tests => 11;

$ENV{UR_DBI_NO_COMMIT} = 1;
$ENV{UR_USE_DUMMY_AUTOGENERATED_IDS} = 1;

BEGIN {
    use_ok( 'Genome::RunChunk::454');
}

my $existing_read_set_id = '2318238553';

my $existing_read_set = Genome::RunChunk::454->get_or_create_from_read_set_id($existing_read_set_id);
isa_ok($existing_read_set,'Genome::RunChunk::454');
is($existing_read_set->seq_id,$existing_read_set_id,'seq_id accessor');

my $new_read_set_id = '2684928940';
my $run_region_454 = GSC::RunRegion454->get($new_read_set_id);
isa_ok($run_region_454,'GSC::RunRegion454');
my $expected_full_path = '/gscmnt/833/info/medseq/sample_data/'. $run_region_454->run_name .'/'. $run_region_454->region_id .'/';


my $new_read_set = Genome::RunChunk::454->get_or_create_from_read_set_id($new_read_set_id);
isa_ok($new_read_set,'Genome::RunChunk::454');

is($new_read_set->seq_id,$new_read_set_id,'seq_id accessor');
is($new_read_set->sequencing_platform,'454','sequencing_platform accessor');
is($new_read_set->sample_name,$run_region_454->sample_name,'sample_name accessor');
is($new_read_set->run_name,$run_region_454->run_name,'run_name accessor');
is($new_read_set->subset_name,$run_region_454->region_number,'subset_name accessor');
is($new_read_set->full_path,$expected_full_path,'full_path accessor');
UR::Context->_sync_databases();
exit;
