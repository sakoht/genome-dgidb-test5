<?xml version='1.0' standalone='yes'?>
<workflow name="gene prediction pipeline" executor="Workflow::Executor::SerialDeferred">
  <link fromOperation="input connector" fromProperty="seq set id" toOperation="get sequence fasta files" toProperty="seq_set_id" />
  <link fromOperation="input connector" fromProperty="seq set id" toOperation="wait delete" toProperty="seq_set_id" />
  <link fromOperation="input connector" fromProperty="seq set id" toOperation="database upload" toProperty="seq_set_id" />
  <link fromOperation="input connector" fromProperty="dev flag" toOperation="get sequence fasta files" toProperty="dev" />
  <link fromOperation="input connector" fromProperty="dev flag" toOperation="database upload" toProperty="dev" />
  <link fromOperation="get sequence fasta files" fromProperty="fasta_files" toOperation="build glimmer3 data" toProperty="fasta_files" />
  <link fromOperation="get sequence fasta files" fromProperty="fasta_files" toOperation="calculate gc percent" toProperty="fasta_files" />
  <link fromOperation="get sequence fasta files" fromProperty="fasta_files" toOperation="contig predict genes" toProperty="fasta file" />
  <link fromOperation="build glimmer3 data" fromProperty="model_file" toOperation="contig predict genes" toProperty="glimmer3 model" />
  <link fromOperation="build glimmer3 data" fromProperty="pwm_file" toOperation="contig predict genes" toProperty="glimmer3 pwm" />
  <link fromOperation="calculate gc percent" fromProperty="gc_percent" toOperation="contig predict genes" toProperty="gc content" />
  <link fromOperation="contig predict genes" fromProperty="bio seq features" toOperation="database upload" toProperty="bio_seq_features" />
  <link fromOperation="database upload" fromProperty="result" toOperation="wait db upload" toProperty="db upload result" />
  <link fromOperation="get sequence fasta files" fromProperty="fasta_files" toOperation="wait db upload" toProperty="fasta_files" />
  <link fromOperation="wait db upload" fromProperty="fasta_files" toOperation="delete fasta" toProperty="fasta_files" />
  <link fromOperation="wait db upload" fromProperty="db upload result" toOperation="wait delete" toProperty="db upload result" />
  <link fromOperation="delete fasta" fromProperty="result" toOperation="wait delete" toProperty="delete result" />
  <link fromOperation="wait delete" fromProperty="seq_set_id" toOperation="mail" toProperty="seq_set_id" />
  <link fromOperation="mail" fromProperty="result" toOperation="output connector" toProperty="result" />
  <operation name="get sequence fasta files">
    <operationtype commandClass="MGAP::Command::GetFastaFiles" typeClass="Workflow::OperationType::Command" />
  </operation>
  <operation name="build glimmer3 data">
    <operationtype commandClass="MGAP::Command::BuildGlimmerInput" typeClass="Workflow::OperationType::Command" />
  </operation>
  <operation name="calculate gc percent">
    <operationtype commandClass="MGAP::Command::CalculateGcPercent" typeClass="Workflow::OperationType::Command" />
  </operation>
  <operation name="contig predict genes" workflowFile="mgap_contig.xml" />
  <operation name="database upload">
    <operationtype commandClass="MGAP::Command::UploadResult" typeClass="Workflow::OperationType::Command" />
  </operation>
  <operation name="wait db upload">
    <operationtype typeClass="Workflow::OperationType::Block">
      <property>fasta_files</property>
      <property>db upload result</property>
    </operationtype>
  </operation>
  <operation name="delete fasta">
    <operationtype commandClass="MGAP::Command::DeleteFastaFiles" typeClass="Workflow::OperationType::Command" />
  </operation>
  <operation name="wait delete">
    <operationtype typeClass="Workflow::OperationType::Block">
      <property>delete result</property>
      <property>db upload result</property>
      <property>seq_set_id</property>
    </operationtype>
  </operation>
  <operation name="mail">
    <operationtype typeClass="Workflow::OperationType::Mail">
      <inputproperty default="eclark@genome.wustl.edu">email_address</inputproperty>
      <inputproperty default="MGAP Workflow">subject</inputproperty>
      <inputproperty default="data/output_mail.txt">template_file</inputproperty>
      <inputproperty>seq_set_id</inputproperty>
    </operationtype>
  </operation>
  <operationtype typeClass="Workflow::OperationType::Model">
    <inputproperty>seq set id</inputproperty>
    <inputproperty>dev flag</inputproperty>
    <outputproperty>result</outputproperty>
  </operationtype>
</workflow>
